const canvasW=640,canvasH=480;async function init(){c=document.getElementById("canvas"),ctx=c.getContext("2d"),canvasLoadState(),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({video:!0}).then(function(t){video.srcObject=t,video.play()}),model=await handpose.load(),myInterval=setInterval(main,200)}async function main(){const t=await model.estimateHands(video);if(clearCanvas(),t.length>0)for(let e=0;e<t.length;e++){keypoints=t[e].landmarks,prevX=0,prevY=0;for(let t=0;t<keypoints.length;t++)[x,y,z]=keypoints[t],prevX>0&&connectFinger(prevX,prevY,x,y),markFinger(x,y),prevX=x,prevY=y}}function canvasLoadState(){ctx.fillStyle="#3955B9",ctx.fillRect(0,0,canvasW,canvasH),ctx.fillStyle="#FFF",ctx.font="18px Arial",ctx.fillText("Loading. This may take a few moments due to training.",50,50),ctx.fillText("Designed for use in landscape mode.",50,150),ctx.fillText("Enable camera access and raise your hand to start.",50,250),ctx.fillText("Lloyd Wilson 2020.",50,350)}function clearCanvas(){ctx.clearRect(0,0,canvasW,canvasH)}function markFinger(t,e){ctx.fillStyle="#960196",ctx.beginPath(),ctx.arc(t,e,3,0,2*Math.PI),ctx.fill()}function connectFinger(t,e,a,n){ctx.strokeStyle="#960196",ctx.beginPath(),ctx.moveTo(t,e),ctx.lineTo(a,n),ctx.stroke()}function drawStatic(){pixelWidth=4,pixelHeight=3;for(var t=0;t<canvasH;t+=pixelHeight)for(var e=0;e<canvasW;e+=pixelWidth)lum=Math.floor(40*Math.random()),ctx.fillStyle="hsl(0, 0%,"+lum+"%)",ctx.fillRect(e,t,pixelWidth,pixelHeight);requestAnimationFrame(drawStatic)}
